{
  "timestamp": "2025-10-27T06:44:34.663Z",
  "proceso": "LIMPIEZA_INTEGRAL_BASES_DATOS",
  "version": "1.0.0",
  "resumenEjecutivo": {
    "objetivo": "Análisis integral y limpieza de bases de datos del sistema TodoFru",
    "alcance": "Identificación, análisis, respaldo y eliminación segura de bases de datos problemáticas",
    "duracion": "Proceso completado en una sesión",
    "resultadoPrincipal": "Sistema optimizado con eliminación exitosa de bases defectuosas",
    "impacto": {
      "basesEliminadas": 2,
      "espacioLiberado": 98304,
      "integridadSistema": "PRESERVADA",
      "funcionamientoCritico": "NO_AFECTADO"
    }
  },
  "fases": [
    {
      "fase": 1,
      "nombre": "IDENTIFICACIÓN_Y_ANÁLISIS",
      "descripcion": "Identificación de todas las bases de datos y análisis de problemas",
      "estado": "COMPLETADA",
      "resultados": {
        "totalBasesEncontradas": 8,
        "basesDelSistema": 1,
        "basesProblematicas": 2
      },
      "archivos": [
        "REPORTE-ANALISIS-BASES-DATOS.json",
        "REPORTE-OTRAS-BASES-DATOS.json"
      ]
    },
    {
      "fase": 2,
      "nombre": "VERIFICACIÓN_INTEGRIDAD",
      "descripcion": "Verificación de integridad y sincronización del sistema principal",
      "estado": "COMPLETADA",
      "resultados": {
        "verificacionesRealizadas": 5,
        "verificacionesExitosas": 5,
        "problemasDetectados": 0
      },
      "archivos": [
        "REPORTE-INTEGRIDAD.json"
      ]
    },
    {
      "fase": 3,
      "nombre": "CREACIÓN_RESPALDOS",
      "descripcion": "Creación de respaldos de seguridad antes de eliminación",
      "estado": "COMPLETADA",
      "resultados": {
        "respaldosCreados": 2,
        "respaldosFallidos": 0,
        "tamañoTotalRespaldos": 922
      },
      "archivos": [
        "REPORTE-RESPALDOS.json",
        "respaldos-bases-datos/"
      ]
    },
    {
      "fase": 4,
      "nombre": "ELIMINACIÓN_SEGURA",
      "descripcion": "Eliminación segura de bases de datos defectuosas",
      "estado": "COMPLETADA",
      "resultados": {
        "basesEliminadas": 2,
        "basesConservadas": 6,
        "errores": 0,
        "espacioLiberado": 98304
      },
      "archivos": [
        "REPORTE-ELIMINACION-BASES.json"
      ]
    }
  ],
  "resultados": {
    "basesAnalizadas": {
      "total": 8,
      "sistemaPrincipal": [
        "todofru"
      ],
      "otrasBasesEncontradas": [
        "grade_db",
        "registro_personas",
        "sistema_parqueo"
      ],
      "basesProblematicas": [
        {
          "nombre": "grade_db",
          "problemas": [
            "Base de datos con tablas pero sin datos"
          ],
          "estado": "sin_datos"
        },
        {
          "nombre": "sistema_parqueo",
          "problemas": [
            "Base de datos con tablas pero sin datos"
          ],
          "estado": "sin_datos"
        }
      ]
    },
    "integridad": {
      "estadoGeneral": "EXCELENTE",
      "verificaciones": {
        "prismaSync": {
          "estado": "OK",
          "conexion": true,
          "ultimasMigraciones": 2,
          "ultimaMigracion": "20251027061717_estructura_optimizada_completa"
        },
        "foreignKeys": {
          "estado": "OK",
          "totalForeignKeys": 21,
          "errores": 0,
          "detalles": [
            {
              "tabla": "auditoria",
              "columna": "usuario_id",
              "referencia": "usuarios.id",
              "huerfanos": 0
            },
            {
              "tabla": "categorias",
              "columna": "categoria_padre_id",
              "referencia": "categorias.id",
              "huerfanos": 0
            },
            {
              "tabla": "clientes",
              "columna": "persona_id",
              "referencia": "personas.id",
              "huerfanos": 0
            },
            {
              "tabla": "movimientos_inventario",
              "columna": "pedido_compra_id",
              "referencia": "pedidos_compra.id",
              "huerfanos": 0
            },
            {
              "tabla": "movimientos_inventario",
              "columna": "producto_id",
              "referencia": "productos.id",
              "huerfanos": 0
            },
            {
              "tabla": "movimientos_inventario",
              "columna": "tipo_movimiento_id",
              "referencia": "tipos_movimiento.id",
              "huerfanos": 0
            },
            {
              "tabla": "movimientos_inventario",
              "columna": "usuario_id",
              "referencia": "usuarios.id",
              "huerfanos": 0
            },
            {
              "tabla": "pedidos_compra",
              "columna": "estado_id",
              "referencia": "estados_pedido.id",
              "huerfanos": 0
            },
            {
              "tabla": "pedidos_compra",
              "columna": "proveedor_id",
              "referencia": "proveedores.persona_id",
              "huerfanos": 0
            },
            {
              "tabla": "pedidos_compra",
              "columna": "usuario_creacion_id",
              "referencia": "usuarios.id",
              "huerfanos": 0
            },
            {
              "tabla": "pedidos_compra",
              "columna": "usuario_modificacion_id",
              "referencia": "usuarios.id",
              "huerfanos": 0
            },
            {
              "tabla": "pedidos_compra_items",
              "columna": "pedido_id",
              "referencia": "pedidos_compra.id",
              "huerfanos": 0
            },
            {
              "tabla": "pedidos_compra_items",
              "columna": "producto_id",
              "referencia": "productos.id",
              "huerfanos": 0
            },
            {
              "tabla": "personas_juridicas",
              "columna": "persona_id",
              "referencia": "personas.id",
              "huerfanos": 0
            },
            {
              "tabla": "personas_naturales",
              "columna": "persona_id",
              "referencia": "personas.id",
              "huerfanos": 0
            },
            {
              "tabla": "productos",
              "columna": "categoria_id",
              "referencia": "categorias.id",
              "huerfanos": 0
            },
            {
              "tabla": "productos",
              "columna": "unidad_medida_id",
              "referencia": "unidades_medida.id",
              "huerfanos": 0
            },
            {
              "tabla": "productos_proveedores",
              "columna": "producto_id",
              "referencia": "productos.id",
              "huerfanos": 0
            },
            {
              "tabla": "productos_proveedores",
              "columna": "proveedor_id",
              "referencia": "proveedores.persona_id",
              "huerfanos": 0
            },
            {
              "tabla": "proveedores",
              "columna": "persona_id",
              "referencia": "personas.id",
              "huerfanos": 0
            },
            {
              "tabla": "unidades_medida",
              "columna": "unidad_base_id",
              "referencia": "unidades_medida.id",
              "huerfanos": 0
            }
          ]
        },
        "indices": {
          "estado": "OK",
          "totalIndices": 107,
          "indicesPorTabla": [
            {
              "tabla": "_prisma_migrations",
              "indices": 1
            },
            {
              "tabla": "auditoria",
              "indices": 8
            },
            {
              "tabla": "categorias",
              "indices": 7
            },
            {
              "tabla": "clientes",
              "indices": 3
            },
            {
              "tabla": "estados_pedido",
              "indices": 4
            },
            {
              "tabla": "movimientos_inventario",
              "indices": 13
            },
            {
              "tabla": "pedidos_compra",
              "indices": 11
            },
            {
              "tabla": "pedidos_compra_items",
              "indices": 5
            },
            {
              "tabla": "personas",
              "indices": 6
            },
            {
              "tabla": "personas_juridicas",
              "indices": 3
            },
            {
              "tabla": "personas_naturales",
              "indices": 3
            },
            {
              "tabla": "productos",
              "indices": 14
            },
            {
              "tabla": "productos_proveedores",
              "indices": 7
            },
            {
              "tabla": "proveedores",
              "indices": 3
            },
            {
              "tabla": "tipos_movimiento",
              "indices": 4
            },
            {
              "tabla": "unidades_medida",
              "indices": 8
            },
            {
              "tabla": "usuarios",
              "indices": 7
            }
          ]
        },
        "constraints": {
          "estado": "OK",
          "totalConstraints": 52,
          "tipos": {
            "PRIMARY KEY": 17,
            "FOREIGN KEY": 21,
            "UNIQUE": 14
          }
        },
        "migraciones": {
          "estado": "OK",
          "migracionesPendientes": 0,
          "ultimasMigraciones": [
            {
              "nombre": "20251027061717_estructura_optimizada_completa",
              "fecha": "2025-10-27T06:17:52.997Z"
            },
            {
              "nombre": "20251024091504_add_numero_identificacion_field",
              "fecha": "2025-10-27T06:16:38.808Z"
            }
          ]
        }
      },
      "problemas": []
    },
    "respaldos": {
      "exitosos": [
        {
          "baseDatos": "grade_db",
          "archivo": "grade_db_backup_2025-10-27T06-42-00-731Z.sql",
          "ruta": "C:\\Users\\Martin\\todafru\\todofru\\respaldos-bases-datos\\grade_db_backup_2025-10-27T06-42-00-731Z.sql",
          "timestamp": "2025-10-27T06-42-00-731Z",
          "estado": "completado",
          "tamaño": 340,
          "estructura": {
            "totalTablas": 1,
            "tablas": [
              {
                "nombre": "calificaciones",
                "filas": 0,
                "tamaño": 16384,
                "comentario": ""
              }
            ],
            "tamañoTotal": 16384
          },
          "datos": null
        },
        {
          "baseDatos": "sistema_parqueo",
          "archivo": "sistema_parqueo_backup_2025-10-27T06-42-00-743Z.sql",
          "ruta": "C:\\Users\\Martin\\todafru\\todofru\\respaldos-bases-datos\\sistema_parqueo_backup_2025-10-27T06-42-00-743Z.sql",
          "timestamp": "2025-10-27T06-42-00-743Z",
          "estado": "completado",
          "tamaño": 582,
          "estructura": {
            "totalTablas": 4,
            "tablas": [
              {
                "nombre": "cliente",
                "filas": 0,
                "tamaño": 16384,
                "comentario": ""
              },
              {
                "nombre": "rol",
                "filas": 0,
                "tamaño": 16384,
                "comentario": ""
              },
              {
                "nombre": "usuario",
                "filas": 0,
                "tamaño": 16384,
                "comentario": ""
              },
              {
                "nombre": "usuario_rol",
                "filas": 0,
                "tamaño": 32768,
                "comentario": ""
              }
            ],
            "tamañoTotal": 81920
          },
          "datos": null
        }
      ],
      "fallidos": [],
      "ubicacion": "respaldos-bases-datos/",
      "tamañoTotal": 922
    },
    "eliminaciones": {
      "basesEliminadas": [
        {
          "nombre": "grade_db",
          "estado": "ELIMINADA",
          "tamañoBytes": 16384,
          "tamañoKB": "16.00",
          "totalTablas": 1,
          "timestamp": "2025-10-27T06:43:08.347Z",
          "mensaje": "Eliminación exitosa"
        },
        {
          "nombre": "sistema_parqueo",
          "estado": "ELIMINADA",
          "tamañoBytes": 81920,
          "tamañoKB": "80.00",
          "totalTablas": 4,
          "timestamp": "2025-10-27T06:43:08.743Z",
          "mensaje": "Eliminación exitosa"
        }
      ],
      "espacioLiberado": 98304,
      "verificacionesPost": [
        {
          "tipo": "ESTADO_FINAL",
          "estado": "OK",
          "basesRestantes": 6,
          "bases": [
            "information_schema",
            "mysql",
            "performance_schema",
            "registro_personas",
            "sys",
            "todofru"
          ],
          "mensaje": "Verificación de estado final completada"
        },
        {
          "tipo": "BASE_PRINCIPAL_POST",
          "estado": "OK",
          "mensaje": "Base principal operativa después de eliminaciones"
        }
      ]
    }
  },
  "recomendaciones": [
    {
      "categoria": "MANTENIMIENTO_PREVENTIVO",
      "prioridad": "MEDIA",
      "descripcion": "Implementar monitoreo regular de bases de datos",
      "acciones": [
        "Ejecutar análisis mensual de bases de datos",
        "Configurar alertas para bases sin actividad",
        "Revisar periódicamente el crecimiento de datos"
      ]
    },
    {
      "categoria": "RESPALDOS",
      "prioridad": "ALTA",
      "descripcion": "Mantener política de respaldos actualizada",
      "acciones": [
        "Conservar respaldos creados por al menos 6 meses",
        "Documentar procedimientos de restauración",
        "Probar restauración de respaldos periódicamente"
      ]
    },
    {
      "categoria": "SEGURIDAD",
      "prioridad": "ALTA",
      "descripcion": "Fortalecer controles de acceso a bases de datos",
      "acciones": [
        "Revisar permisos de usuarios de base de datos",
        "Implementar auditoría de cambios en esquemas",
        "Establecer procedimientos para creación de nuevas bases"
      ]
    }
  ],
  "archivosGenerados": [
    {
      "nombre": "REPORTE-ANALISIS-BASES-DATOS.json",
      "tamaño": 4029,
      "fechaCreacion": "2025-10-27T06:37:48.398Z",
      "tipo": "ARCHIVO"
    },
    {
      "nombre": "REPORTE-OTRAS-BASES-DATOS.json",
      "tamaño": 2050,
      "fechaCreacion": "2025-10-27T06:38:46.871Z",
      "tipo": "ARCHIVO"
    },
    {
      "nombre": "REPORTE-INTEGRIDAD.json",
      "tamaño": 6127,
      "fechaCreacion": "2025-10-27T06:39:54.210Z",
      "tipo": "ARCHIVO"
    },
    {
      "nombre": "REPORTE-RESPALDOS.json",
      "tamaño": 1875,
      "fechaCreacion": "2025-10-27T06:42:00.753Z",
      "tipo": "ARCHIVO"
    },
    {
      "nombre": "REPORTE-ELIMINACION-BASES.json",
      "tamaño": 1656,
      "fechaCreacion": "2025-10-27T06:43:08.748Z",
      "tipo": "ARCHIVO"
    },
    {
      "nombre": "respaldos-bases-datos/",
      "tamaño": 0,
      "fechaCreacion": "2025-10-27T06:41:25.727Z",
      "tipo": "DIRECTORIO"
    },
    {
      "nombre": "scripts/analizar-bases-datos.js",
      "tamaño": 12245,
      "fechaCreacion": "2025-10-27T06:33:20.263Z",
      "tipo": "ARCHIVO"
    },
    {
      "nombre": "scripts/analizar-otras-bases.js",
      "tamaño": 8714,
      "fechaCreacion": "2025-10-27T06:38:39.766Z",
      "tipo": "ARCHIVO"
    },
    {
      "nombre": "scripts/verificar-integridad.js",
      "tamaño": 11267,
      "fechaCreacion": "2025-10-27T06:39:39.085Z",
      "tipo": "ARCHIVO"
    },
    {
      "nombre": "scripts/crear-respaldos.js",
      "tamaño": 9972,
      "fechaCreacion": "2025-10-27T06:41:10.831Z",
      "tipo": "ARCHIVO"
    },
    {
      "nombre": "scripts/eliminar-bases-defectuosas.js",
      "tamaño": 11209,
      "fechaCreacion": "2025-10-27T06:42:53.371Z",
      "tipo": "ARCHIVO"
    }
  ],
  "estadoFinal": {
    "sistemaOperativo": true,
    "basePrincipalIntacta": true,
    "basesProblematicasEliminadas": 2,
    "espacioLiberadoTotal": "96.00 KB",
    "integridadPreservada": true,
    "respaldosDisponibles": 2,
    "recomendacion": "SISTEMA_OPTIMIZADO_Y_LIMPIO"
  }
}